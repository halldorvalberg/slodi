@import './../../app/slodi-tokens.css';
@import './../../app/slodi-utilities.css';

/* ═══════════════════════════════════════════════════════════════
   SIDEBAR NAVIGATION - Using Slóði Design Tokens
   UPDATED: No header on dashboard routes, sidebar starts at viewport top
   ═══════════════════════════════════════════════════════════════ */

/* ===== SIDEBAR CONTAINER ===== */
.sidebar {
  position: fixed;
  left: 0;
  top: 0; /* Changed from var(--sl-navbar-height, 64px) to 0 */
  bottom: 0;
  width: 240px;
  background: hsl(var(--sl-color-surface));
  border-right: 1px solid hsl(var(--sl-color-border));
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overflow-x: hidden;
  z-index: var(--sl-z-fixed);
  transition: width var(--sl-transition-base);
}

/* Collapsed state */
.sidebarCollapsed {
  width: 64px;
}

/* ===== COLLAPSE BUTTON (INTEGRATED) ===== */
.collapseButtonWrapper {
  padding: 0 var(--sl-spacing-inline);
  margin-top: var(--sl-spacing-element);
}

.collapseButton {
  display: flex;
  align-items: center;
  gap: var(--sl-spacing-gap-md);
  width: 100%;
  padding: var(--sl-spacing-inset-md);
  background: transparent;
  border: none;
  border-radius: var(--sl-radius-button);
  color: hsl(var(--sl-color-text-secondary));
  font-size: var(--sl-text-body);
  font-weight: var(--sl-font-weight-medium);
  cursor: pointer;
  transition: var(--sl-transition-fast);
  white-space: nowrap;
}

/* Compact variant for collapse button */
.collapseButtonCompact {
  padding: var(--sl-spacing-inset-sm);
  font-size: var(--sl-text-body-sm);
}

.collapseButton:hover {
  background: hsl(var(--sl-color-surface-hover));
  color: hsl(var(--sl-color-text-primary));
}

.collapseButton:focus-visible {
  outline: none;
  box-shadow: var(--sl-shadow-focus);
}

.collapseButton:active {
  transform: scale(0.98);
}

.collapseIcon {
  width: var(--sl-size-icon-md);
  height: var(--sl-size-icon-md);
  flex-shrink: 0;
  transition: transform var(--sl-transition-fast);
}

.collapseButton:hover .collapseIcon {
  transform: scale(1.1);
}

.collapseLabel {
  flex: 1;
  text-align: left;
}

/* Collapsed state - center icon only */
.sidebarCollapsed .collapseButtonWrapper {
  padding: 0 var(--sl-spacing-compact);
  margin-top: var(--sl-spacing-element);
}

.sidebarCollapsed .collapseButton {
  justify-content: center;
}

.sidebarCollapsed .collapseButtonCompact {
  padding: var(--sl-spacing-inset-sm);
}

.sidebarCollapsed .collapseLabel {
  display: none;
}

/* ===== NAVIGATION ===== */
.nav {
  display: flex;
  flex-direction: column;
  padding: var(--sl-spacing-component) 0;
  flex: 1;
  overflow-y: auto;
  position: relative;
}

.navList {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: var(--sl-spacing-gap-xs);
  position: relative;
  z-index: 1;
}

/* Personal section pinned to bottom */
.personalList {
  margin-top: auto;
}

/* ===== NAV ITEMS ===== */
.navItem {
  display: flex;
  align-items: center;
  gap: var(--sl-spacing-gap-md);
  padding: var(--sl-spacing-inset-md);
  margin: 0 var(--sl-spacing-inline);
  border-radius: var(--sl-radius-button);
  color: hsl(var(--sl-color-text-secondary));
  text-decoration: none;
  font-size: var(--sl-text-body);
  font-weight: var(--sl-font-weight-medium);
  line-height: var(--sl-line-height-normal);
  transition: var(--sl-transition-fast);
  cursor: pointer;
  position: relative;
  white-space: nowrap;
}

.navItem:hover {
  background: hsl(var(--sl-color-surface-hover));
  color: hsl(var(--sl-color-text-primary));
}

.navItem:focus-visible {
  outline: none;
  box-shadow: inset 0 0 0 2px hsl(var(--sl-color-primary));
}

/* Active state */
.navItemActive {
  background: hsl(var(--sl-color-primary-subtle));
  color: hsl(var(--sl-color-primary));
  font-weight: var(--sl-font-weight-semibold);
  border-left: 3px solid hsl(var(--sl-color-primary));
  padding-left: calc(var(--sl-spacing-inset-md) - 3px);
}

.navItemActive:hover {
  background: hsl(var(--sl-color-primary-subtle));
}

/* Icon */
.navIcon {
  width: var(--sl-size-icon-md);
  height: var(--sl-size-icon-md);
  flex-shrink: 0;
}

/* Label */
.navLabel {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Badge (notification count) */
.navBadge {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 20px;
  height: 20px;
  padding: 0 var(--sl-spacing-compact);
  background: hsl(var(--sl-color-error));
  color: hsl(var(--sl-color-text-inverse));
  border-radius: var(--sl-radius-badge);
  font-size: var(--sl-primitive-font-size-2xs);
  font-weight: var(--sl-font-weight-bold);
  line-height: 1;
}

/* ===== SEPARATOR ===== */
.navSeparator {
  height: 1px;
  background: hsl(var(--sl-color-border-subtle));
  margin: var(--sl-spacing-element) var(--sl-spacing-component);
  position: relative;
  z-index: 1;
}

/* ===== USER SECTION ===== */
.userSection {
  margin: var(--sl-spacing-element) var(--sl-spacing-inline);
}

.userLink {
  display: flex;
  align-items: center;
  gap: var(--sl-spacing-gap-md);
  padding: var(--sl-spacing-inset-md);
  border-radius: var(--sl-radius-button);
  color: hsl(var(--sl-color-text-primary));
  text-decoration: none;
  font-size: var(--sl-text-body);
  font-weight: var(--sl-font-weight-medium);
  transition: var(--sl-transition-fast);
}

.userLink:hover {
  background: hsl(var(--sl-color-surface-hover));
}

.userLink:focus-visible {
  outline: none;
  box-shadow: inset 0 0 0 2px hsl(var(--sl-color-primary));
}

.userLinkActive {
  background: hsl(var(--sl-color-primary-subtle));
  color: hsl(var(--sl-color-primary));
}

.userAvatar {
  width: var(--sl-size-icon-lg);
  height: var(--sl-size-icon-lg);
  border-radius: var(--sl-radius-avatar);
  border: 2px solid hsl(var(--sl-color-border));
  object-fit: cover;
  flex-shrink: 0;
}

.userAvatarPlaceholder {
  width: var(--sl-size-icon-lg);
  height: var(--sl-size-icon-lg);
  border-radius: var(--sl-radius-avatar);
  background: hsl(var(--sl-color-primary));
  color: hsl(var(--sl-color-text-inverse));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--sl-text-body-lg);
  font-weight: var(--sl-font-weight-bold);
  flex-shrink: 0;
}

.userName {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ===== SKIP LINK (Accessibility) ===== */
.skipLink {
  position: absolute;
  top: -100px;
  left: 0;
  padding: var(--sl-spacing-inset-md);
  background: hsl(var(--sl-color-primary));
  color: hsl(var(--sl-color-text-inverse));
  text-decoration: none;
  font-weight: var(--sl-font-weight-semibold);
  z-index: 9999;
  transition: var(--sl-transition-fast);
}

.skipLink:focus {
  top: 0;
  box-shadow: var(--sl-shadow-focus);
}

/* ===== COLLAPSED STATE ADJUSTMENTS ===== */
.sidebarCollapsed .navLabel,
.sidebarCollapsed .userName,
.sidebarCollapsed .navBadge {
  display: none;
}

.sidebarCollapsed .navItem,
.sidebarCollapsed .userLink {
  justify-content: center;
  padding: var(--sl-spacing-inset-md);
  margin: 0 var(--sl-spacing-compact);
}

.sidebarCollapsed .navItemActive {
  border-left: none;
  border-bottom: 3px solid hsl(var(--sl-color-primary));
  padding: var(--sl-spacing-inset-md);
}

.sidebarCollapsed .userSection {
  margin: var(--sl-spacing-element) var(--sl-spacing-compact);
}

/* ===== RESPONSIVE BREAKPOINTS ===== */

/* Tablet: Force collapsed mode */
@media (min-width: 768px) and (max-width: 1199px) {
  .sidebar {
    width: 64px;
  }

  .navLabel,
  .userName,
  .navBadge,
  .collapseLabel {
    display: none;
  }

  .navItem,
  .userLink {
    justify-content: center;
    padding: var(--sl-spacing-inset-md);
    margin: 0 var(--sl-spacing-compact);
  }

  .navItemActive {
    border-left: none;
    border-bottom: 3px solid hsl(var(--sl-color-primary));
    padding: var(--sl-spacing-inset-md);
  }

  .userSection {
    margin: var(--sl-spacing-element) var(--sl-spacing-compact);
  }

  .collapseButtonWrapper {
    padding: 0 var(--sl-spacing-compact);
    margin-top: var(--sl-spacing-element);
  }

  .collapseButton {
    justify-content: center;
  }

  .collapseButtonCompact {
    padding: var(--sl-spacing-inset-sm);
  }
}

/* Mobile: Hide sidebar by default (use drawer/hamburger) */
@media (max-width: 767px) {
  .sidebar {
    transform: translateX(-100%);
    transition: transform var(--sl-transition-base);
  }

  .sidebar[data-open="true"] {
    transform: translateX(0);
    box-shadow: var(--sl-shadow-modal);
  }

  /* Full width on mobile when open */
  .sidebar[data-open="true"] {
    width: 280px;
  }
}

/* ===== DARK MODE ADJUSTMENTS ===== */
:global(.dark) .sidebar {
  box-shadow: inset -1px 0 0 0 hsl(var(--sl-color-border-subtle));
}

:global(.dark) .collapseButton {
  background: hsl(var(--sl-color-surface));
}

/* ===== SCROLLBAR STYLING ===== */
.sidebar::-webkit-scrollbar {
  width: 6px;
}

.sidebar::-webkit-scrollbar-track {
  background: transparent;
}

.sidebar::-webkit-scrollbar-thumb {
  background: hsl(var(--sl-color-border));
  border-radius: var(--sl-primitive-radius-sm);
}

.sidebar::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--sl-color-border-strong));
}

/* ===== PRINT STYLES ===== */
@media print {
  .sidebar {
    display: none;
  }
}

/* ===== REDUCED MOTION ===== */
@media (prefers-reduced-motion: reduce) {
  .sidebar,
  .navItem,
  .userLink,
  .collapseButton,
  .collapseIcon {
    transition: none;
  }
}

/* ===== HIGH CONTRAST MODE ===== */
@media (prefers-contrast: high) {
  .navItemActive {
    outline: 2px solid currentColor;
  }

  .navItem:focus-visible,
  .userLink:focus-visible,
  .collapseButton:focus-visible {
    outline: 3px solid currentColor;
  }

  .collapseButton {
    border-width: 2px;
  }
}